# Веб-интерфейс StressPulse

Современный веб-интерфейс для управления нагрузочным тестированием в реальном времени.

## Запуск

```bash
# Запуск с веб-интерфейсом
go run main.go -web

# Указать другой порт (по умолчанию 8080)
go run main.go -web -web-port 9000

# Полный запуск с веб-интерфейсом и метриками
go run main.go -web -metrics -web-port 8080
```

После запуска откройте браузер и перейдите по адресу: **http://localhost:8080**

## Возможности

### Control Panel
- **Start All** - запустить все включенные тесты
- **Stop All** - остановить все активные тесты  
- **Restart** - перезапустить тестирование
- **Save Config** - сохранить текущую конфигурацию

### Мониторинг в реальном времени
- **CPU Load** - текущая нагрузка процессора с прогресс-баром
- **Memory Usage** - использование памяти
- **HTTP RPS** - запросов в секунду и процент успешных
- **WebSocket CPS** - соединений в секунду и активные соединения
- **gRPC RPS** - запросов gRPC и статистика

### Настройки

**CPU Load:**
- Включение/выключение нагрузки
- Целевой процент нагрузки (0-100%)
- Паттерн нагрузки (sine, square, sawtooth, random)
- Дрейф нагрузки в процентах

**Memory Load:**
- Включение нагрузки на память
- Целевой размер в MB
- Паттерн использования (constant, leak, spike, cycle, random)

**HTTP Load Testing:**
- Включение HTTP тестирования
- Target URL для запросов
- Целевой RPS (запросов в секунду)
- HTTP метод (GET, POST, PUT, DELETE, PATCH)
- Паттерн нагрузки (constant, spike, cycle, ramp, random)
- Пользовательские заголовки
- Тело запроса (JSON)

**WebSocket Testing:**
- Включение WebSocket тестирования
- WebSocket URL
- CPS (соединений в секунду)
- Паттерн подключений
- Интервал отправки сообщений
- Размер сообщений в байтах

**gRPC Testing:**
- Включение gRPC тестирования
- Адрес gRPC сервера
- Целевой RPS
- Тип метода (health_check, unary, server_stream, client_stream, bidi_stream)
- Паттерн нагрузки
- Использование TLS
- Имя сервиса

**Additional Settings:**
- Включение фейковых логов
- Тип логов (generic, java, web, microservice, database, ecommerce)
- Длительность теста
- Количество worker threads

### Логи в реальном времени
- Просмотр всех событий в реальном времени
- Цветовая маркировка по уровню важности
- Автоскролл к новым записям
- Очистка логов
- Поиск по содержимому

## Примеры использования

### HTTP нагрузочное тестирование API

1. Включите "Enable HTTP Testing"
2. Укажите URL: `http://localhost:3000/api/users`
3. Установите RPS: `100`
4. Выберите метод: `GET`
5. Добавьте заголовки: `Authorization:Bearer token,Content-Type:application/json`
6. Нажмите "Start All"

### WebSocket чат симуляция

1. Включите "Enable WebSocket Testing"
2. URL: `ws://localhost:8080/chat`
3. CPS: `20` (20 новых соединений в секунду)
4. Интервал сообщений: `2` секунды
5. Размер сообщения: `128` байт
6. Запустите тест

### Комплексное тестирование

1. **CPU**: 70%, pattern = sine
2. **Memory**: 300MB, pattern = cycle
3. **HTTP**: 150 RPS на `/api/health`
4. **WebSocket**: 25 CPS на `/ws`
5. **gRPC**: 75 RPS на `localhost:9000`
6. **Логи**: включить java-тип

Все параметры настраиваются в веб-интерфейсе без перезапуска приложения!

## Автосохранение конфигурации

Интерфейс автоматически сохраняет настройки в браузере. При следующем открытии все ваши параметры будут восстановлены.

## API Endpoints

Веб-интерфейс использует REST API, который можно использовать программно:

- `POST /api/start` - запуск тестирования с конфигурацией
- `POST /api/stop` - остановка всех тестов
- `GET /api/stats` - получение текущей статистики
- `GET /api/logs` - получение логов в JSON
- `GET /api/config` - текущая конфигурация

### Пример API запроса

```bash
# Запуск HTTP теста через API
curl -X POST http://localhost:8080/api/start \
  -H "Content-Type: application/json" \
  -d '{
    "http": {
      "enabled": true,
      "url": "http://httpbin.org/get",
      "rps": 50,
      "method": "GET",
      "pattern": "constant"
    }
  }'

# Получение статистики
curl http://localhost:8080/api/stats
```

## Горячие клавиши

- `Ctrl+Enter` - запуск тестирования
- `Ctrl+.` - остановка тестов
- `Ctrl+S` - сохранение конфигурации

## Производительность

Веб-интерфейс обновляет метрики каждые 2 секунды и не влияет на производительность основного тестирования. При высоких RPS (>10k) рекомендуется использовать отдельный браузер.

## Troubleshooting

**Не подключается к веб-интерфейсу:**
- Проверьте, что порт не занят: `netstat -an | grep :8080`
- Убедитесь, что флаг `-web` указан при запуске
- Проверьте firewall настройки

**Медленное обновление метрик:**
- Закройте другие вкладки браузера
- Отключите расширения браузера
- Используйте Chrome или Firefox

**Не сохраняется конфигурация:**
- Проверьте, что в браузере включены cookies
- Очистите localStorage: `localStorage.clear()`